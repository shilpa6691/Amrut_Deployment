21-Mar-24 14:14:02 INFO [es_visualization.py] Processing data to classify aqi location and zonewise ...
21-Mar-24 14:14:02 ERROR [es_visualization.py] Exception occurred:'DateTime'
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 57, in aqi_location_and_zonewise_classification
    processed_data_loc = data_processor.location_and_zonewise_aqi_classifier()
  File "/opt/siap/analytics/es/es_visualization_model.py", line 128, in location_and_zonewise_aqi_classifier
    self.data_ES['DateTime'] = pd.to_datetime(self.data_ES['DateTime'])
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:14:02 INFO [h11_impl.py] 192.168.0.100:55306 - "GET /ES_aqi_classification HTTP/1.1" 500
21-Mar-24 14:14:02 INFO [es_visualization.py] Processing data to generate Average value of pollutants and AQI...
21-Mar-24 14:14:02 ERROR [es_visualization.py] Exception occurred: 'DateTime'
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 91, in monthly_average_value_of_6_pollutants_and_aqi
    aqi_data,pollutants_data = data_processor.average_value_of_variables()
  File "/opt/siap/analytics/es/es_visualization_model.py", line 181, in average_value_of_variables
    data_ES_avg = self.df_to_TS(self.data_ES,'DateTime')
  File "/opt/siap/analytics/es/es_visualization_model.py", line 115, in df_to_TS
    df[datecol] = pd.to_datetime(df[datecol])
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:14:02 INFO [h11_impl.py] 192.168.0.100:55308 - "GET /ES_monthly_average_values_of_pollutants_and_aqi HTTP/1.1" 500
21-Mar-24 14:14:02 INFO [es_visualization.py] Processing data to generate outlier...
21-Mar-24 14:14:02 ERROR [es_visualization.py] Exception occurred:'DateTime'.
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 129, in ids_vs_outlier
    processed_data = data_processor.outlier_detection(df_assetloc)
  File "/opt/siap/analytics/es/es_visualization_model.py", line 223, in outlier_detection
    self.data_ES['DateTime'] = pd.to_datetime(self.data_ES['DateTime'])
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:14:02 INFO [h11_impl.py] 192.168.0.100:55316 - "GET /ES_outlier HTTP/1.1" 500
21-Mar-24 14:14:02 INFO [es_visualization.py] Processing value counts data...
21-Mar-24 14:14:02 ERROR [es_visualization.py] Exception occurred:"None of [Index(['DateTime', 'id', 'PM10'], dtype='object')] are in the [columns]".
Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 168, in daywise_valuecounts_for_pollutants
    processed_data_dict[f'processed_data_{pollutant}'] = data_processor.pollutants_valuecount_classifier(pollutant)
  File "/opt/siap/analytics/es/es_visualization_model.py", line 159, in pollutants_valuecount_classifier
    data = self.data_ES[['DateTime', 'id', pollutant]]
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3767, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 5877, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 5938, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['DateTime', 'id', 'PM10'], dtype='object')] are in the [columns]"
21-Mar-24 14:14:02 INFO [h11_impl.py] 192.168.0.100:55332 - "GET /ES_pollutants_value_count HTTP/1.1" 500
21-Mar-24 14:14:03 INFO [es_visualization.py] Loading csv file
21-Mar-24 14:14:03 INFO [es_visualization.py] Processing es map creation data...
21-Mar-24 14:14:03 ERROR [es_visualization.py] Exception occurred: 'DateTime'
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 197, in aqi_map_creation_data
    processed_data = data_processor.map_creation_AQI()
  File "/opt/siap/analytics/es/es_visualization_model.py", line 275, in map_creation_AQI
    data['DateTime'] = pd.to_datetime(data['DateTime']).dt.date
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:14:03 INFO [h11_impl.py] 192.168.0.100:55346 - "GET /ES_data_for_map HTTP/1.1" 500
21-Mar-24 14:16:31 INFO [server.py] Shutting down
21-Mar-24 14:16:31 INFO [on.py] Waiting for application shutdown.
21-Mar-24 14:16:31 INFO [on.py] Application shutdown complete.
21-Mar-24 14:16:31 INFO [server.py] Finished server process [1468996]
21-Mar-24 14:17:43 INFO [es_visualization.py] Processing data to classify aqi location and zonewise ...
21-Mar-24 14:17:43 ERROR [es_visualization.py] Exception occurred:'DateTime'
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 57, in aqi_location_and_zonewise_classification
    processed_data_loc = data_processor.location_and_zonewise_aqi_classifier()
  File "/opt/siap/analytics/es/es_visualization_model.py", line 128, in location_and_zonewise_aqi_classifier
    self.data_ES['DateTime'] = pd.to_datetime(self.data_ES['DateTime'])
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:17:43 INFO [h11_impl.py] 192.168.0.100:42238 - "GET /ES_aqi_classification HTTP/1.1" 500
21-Mar-24 14:17:43 INFO [es_visualization.py] Processing data to generate Average value of pollutants and AQI...
21-Mar-24 14:17:43 ERROR [es_visualization.py] Exception occurred: 'DateTime'
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 91, in monthly_average_value_of_6_pollutants_and_aqi
    aqi_data,pollutants_data = data_processor.average_value_of_variables()
  File "/opt/siap/analytics/es/es_visualization_model.py", line 181, in average_value_of_variables
    data_ES_avg = self.df_to_TS(self.data_ES,'DateTime')
  File "/opt/siap/analytics/es/es_visualization_model.py", line 115, in df_to_TS
    df[datecol] = pd.to_datetime(df[datecol])
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:17:43 INFO [h11_impl.py] 192.168.0.100:42244 - "GET /ES_monthly_average_values_of_pollutants_and_aqi HTTP/1.1" 500
21-Mar-24 14:17:43 INFO [es_visualization.py] Processing data to generate outlier...
21-Mar-24 14:17:43 ERROR [es_visualization.py] Exception occurred:'DateTime'.
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 129, in ids_vs_outlier
    processed_data = data_processor.outlier_detection(df_assetloc)
  File "/opt/siap/analytics/es/es_visualization_model.py", line 223, in outlier_detection
    self.data_ES['DateTime'] = pd.to_datetime(self.data_ES['DateTime'])
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:17:43 INFO [h11_impl.py] 192.168.0.100:42254 - "GET /ES_outlier HTTP/1.1" 500
21-Mar-24 14:17:43 INFO [es_visualization.py] Processing value counts data...
21-Mar-24 14:17:43 ERROR [es_visualization.py] Exception occurred:"None of [Index(['DateTime', 'id', 'PM10'], dtype='object')] are in the [columns]".
Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 168, in daywise_valuecounts_for_pollutants
    processed_data_dict[f'processed_data_{pollutant}'] = data_processor.pollutants_valuecount_classifier(pollutant)
  File "/opt/siap/analytics/es/es_visualization_model.py", line 159, in pollutants_valuecount_classifier
    data = self.data_ES[['DateTime', 'id', pollutant]]
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3767, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 5877, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 5938, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['DateTime', 'id', 'PM10'], dtype='object')] are in the [columns]"
21-Mar-24 14:17:43 INFO [h11_impl.py] 192.168.0.100:42258 - "GET /ES_pollutants_value_count HTTP/1.1" 500
21-Mar-24 14:17:43 INFO [es_visualization.py] Loading csv file
21-Mar-24 14:17:43 INFO [es_visualization.py] Processing es map creation data...
21-Mar-24 14:17:43 ERROR [es_visualization.py] Exception occurred: 'DateTime'
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 197, in aqi_map_creation_data
    processed_data = data_processor.map_creation_AQI()
  File "/opt/siap/analytics/es/es_visualization_model.py", line 275, in map_creation_AQI
    data['DateTime'] = pd.to_datetime(data['DateTime']).dt.date
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:17:43 INFO [h11_impl.py] 192.168.0.100:42264 - "GET /ES_data_for_map HTTP/1.1" 500
21-Mar-24 14:19:27 INFO [h11_impl.py] 192.168.150.14:60215 - "GET /docs HTTP/1.1" 200
21-Mar-24 14:19:27 INFO [h11_impl.py] 192.168.150.14:60215 - "GET /openapi.json HTTP/1.1" 200
21-Mar-24 14:19:37 INFO [es_model_fitting.py] Venv Path(Model Fitting): /opt/siap/analytics/analytics_env/bin/python3

21-Mar-24 14:19:40 INFO [es_model_fitting.py] TS data cleaning completed.
21-Mar-24 14:19:43 INFO [es_model_fitting.py] The model is fitted for region Beach_Park.
21-Mar-24 14:19:43 INFO [es_model_fitting.py] pickle file for modelresults zone Beach_Park created successfully
21-Mar-24 14:19:43 INFO [es_model_fitting.py] pickle file for fitresults zone Beach_Park created successfully
21-Mar-24 14:19:45 INFO [es_model_fitting.py] The model is fitted for region Changi_Boardwalk.
21-Mar-24 14:19:45 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Boardwalk created successfully
21-Mar-24 14:19:45 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Boardwalk created successfully
21-Mar-24 14:19:47 INFO [es_model_fitting.py] The model is fitted for region Changi_Chapel_Museum.
21-Mar-24 14:19:47 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Chapel_Museum created successfully
21-Mar-24 14:19:47 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Chapel_Museum created successfully
21-Mar-24 14:19:49 INFO [es_model_fitting.py] The model is fitted for region Changi_Cove_Park.
21-Mar-24 14:19:49 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Cove_Park created successfully
21-Mar-24 14:19:49 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Cove_Park created successfully
21-Mar-24 14:20:00 INFO [es_model_fitting.py] The model is fitted for region Changi_Golf_Club.
21-Mar-24 14:20:00 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Golf_Club created successfully
21-Mar-24 14:20:00 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Golf_Club created successfully
21-Mar-24 14:20:10 INFO [es_model_fitting.py] The model is fitted for region Changi_Jurassic_Mile.
21-Mar-24 14:20:10 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Jurassic_Mile created successfully
21-Mar-24 14:20:10 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Jurassic_Mile created successfully
21-Mar-24 14:20:16 INFO [es_model_fitting.py] The model is fitted for region Changi_Point_Ferry_Terminal.
21-Mar-24 14:20:16 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Point_Ferry_Terminal created successfully
21-Mar-24 14:20:16 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Point_Ferry_Terminal created successfully
21-Mar-24 14:20:18 INFO [es_model_fitting.py] The model is fitted for region Changi_Sailing_Club.
21-Mar-24 14:20:18 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Sailing_Club created successfully
21-Mar-24 14:20:18 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Sailing_Club created successfully
21-Mar-24 14:20:26 INFO [es_model_fitting.py] The model is fitted for region Changi_Village.
21-Mar-24 14:20:26 INFO [es_model_fitting.py] pickle file for modelresults zone Changi_Village created successfully
21-Mar-24 14:20:26 INFO [es_model_fitting.py] pickle file for fitresults zone Changi_Village created successfully
21-Mar-24 14:20:31 INFO [es_model_fitting.py] The model is fitted for region City_Point_Mall.
21-Mar-24 14:20:31 INFO [es_model_fitting.py] pickle file for modelresults zone City_Point_Mall created successfully
21-Mar-24 14:20:31 INFO [es_model_fitting.py] pickle file for fitresults zone City_Point_Mall created successfully
21-Mar-24 14:20:33 INFO [es_model_fitting.py] The model is fitted for region Creek_Reservoir_Park.
21-Mar-24 14:20:33 INFO [es_model_fitting.py] pickle file for modelresults zone Creek_Reservoir_Park created successfully
21-Mar-24 14:20:33 INFO [es_model_fitting.py] pickle file for fitresults zone Creek_Reservoir_Park created successfully
21-Mar-24 14:20:34 INFO [es_model_fitting.py] The model is fitted for region Point_Coastal_Walk.
21-Mar-24 14:20:34 INFO [es_model_fitting.py] pickle file for modelresults zone Point_Coastal_Walk created successfully
21-Mar-24 14:20:34 INFO [es_model_fitting.py] pickle file for fitresults zone Point_Coastal_Walk created successfully
21-Mar-24 14:20:49 INFO [es_model_fitting.py] The model is fitted for region Tampines Mall.
21-Mar-24 14:20:49 INFO [es_model_fitting.py] pickle file for modelresults zone Tampines Mall created successfully
21-Mar-24 14:20:49 INFO [es_model_fitting.py] pickle file for fitresults zone Tampines Mall created successfully
21-Mar-24 14:20:49 INFO [es_model_fitting.py] Model fitting of all zones completed successfully
21-Mar-24 14:20:49 INFO [h11_impl.py] 192.168.150.14:60220 - "POST /ES_model_fitting?subsystem_name_for_pickle_file=es&test_size=2&validation_size=2 HTTP/1.1" 200
21-Mar-24 14:21:29 INFO [es_storing_csv_as_pickle.py] Venv Path(Storing csv as pickle file): /opt/siap/analytics/analytics_env/bin/python3

21-Mar-24 14:21:32 INFO [es_storing_csv_as_pickle.py] The csv file is saved as a pickle file
21-Mar-24 14:21:32 INFO [h11_impl.py] 192.168.150.14:60247 - "POST /ES_storing_csv_pickle?subsystem_name_for_pickle_file=es HTTP/1.1" 200
21-Mar-24 14:22:18 INFO [es_forecasting.py] Forecasted data was saved successfully
21-Mar-24 14:22:18 INFO [h11_impl.py] 192.168.150.14:60251 - "GET /ES_forecasting?test_size=2&validation_size=2&subsystem_name_for_pickle_file=es HTTP/1.1" 200
21-Mar-24 14:24:04 INFO [es_visualization.py] Processing data to classify aqi location and zonewise ...
21-Mar-24 14:24:04 ERROR [es_visualization.py] Exception occurred:'DateTime'
Traceback (most recent call last):
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 57, in aqi_location_and_zonewise_classification
    processed_data_loc = data_processor.location_and_zonewise_aqi_classifier()
  File "/opt/siap/analytics/es/es_visualization_model.py", line 128, in location_and_zonewise_aqi_classifier
    self.data_ES['DateTime'] = pd.to_datetime(self.data_ES['DateTime'])
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'
21-Mar-24 14:24:04 INFO [h11_impl.py] 192.168.150.14:60282 - "GET /ES_aqi_classification HTTP/1.1" 500
21-Mar-24 14:26:26 INFO [server.py] Shutting down
21-Mar-24 14:26:26 INFO [on.py] Waiting for application shutdown.
21-Mar-24 14:26:26 INFO [on.py] Application shutdown complete.
21-Mar-24 14:26:26 INFO [server.py] Finished server process [1469915]
21-Mar-24 14:27:30 INFO [es_visualization.py] Processing data to classify aqi location and zonewise ...
21-Mar-24 14:27:31 INFO [es_visualization.py] Aqi location and zonewise classification completed.
21-Mar-24 14:27:31 INFO [h11_impl.py] 192.168.150.14:60335 - "GET /ES_aqi_classification HTTP/1.1" 200
21-Mar-24 14:27:40 INFO [es_visualization.py] Processing data to generate Average value of pollutants and AQI...
21-Mar-24 14:27:43 INFO [es_visualization.py] Average values of pollutants and aqi data processing completed.
21-Mar-24 14:27:43 INFO [h11_impl.py] 192.168.150.14:60340 - "GET /ES_monthly_average_values_of_pollutants_and_aqi HTTP/1.1" 200
21-Mar-24 14:27:52 INFO [es_visualization.py] Processing data to generate outlier...
21-Mar-24 14:27:52 ERROR [es_visualization.py] Exception occurred:'Loc id'.
Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 131, in ids_vs_outlier
    processed_data = data_processor.outlier_detection(df_assetloc)
  File "/opt/siap/analytics/es/es_visualization_model.py", line 267, in outlier_detection
    value_count_data_new =df_assetloc.merge(value_count_data_new,on='Loc id')
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/frame.py", line 9843, in merge
    return merge(
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 148, in merge
    op = _MergeOperation(
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 737, in __init__
    ) = self._get_merge_keys()
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 1221, in _get_merge_keys
    left_keys.append(left._get_label_or_level_values(lk))
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/core/generic.py", line 1778, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'Loc id'
21-Mar-24 14:27:52 INFO [h11_impl.py] 192.168.150.14:60346 - "GET /ES_outlier HTTP/1.1" 500
21-Mar-24 14:28:01 INFO [es_visualization.py] Processing value counts data...
21-Mar-24 14:28:06 INFO [es_visualization.py] Value counts data processing PM10 completed.
21-Mar-24 14:28:10 INFO [es_visualization.py] Value counts data processing PM25 completed.
21-Mar-24 14:28:16 INFO [es_visualization.py] Value counts data processing SO2 completed.
21-Mar-24 14:28:20 INFO [es_visualization.py] Value counts data processing CO completed.
21-Mar-24 14:28:25 INFO [es_visualization.py] Value counts data processing O3 completed.
21-Mar-24 14:28:30 INFO [es_visualization.py] Value counts data processing NO2 completed.
21-Mar-24 14:28:30 INFO [h11_impl.py] 192.168.150.14:60348 - "GET /ES_pollutants_value_count HTTP/1.1" 200
21-Mar-24 14:29:02 INFO [es_visualization.py] Loading csv file
21-Mar-24 14:29:02 INFO [es_visualization.py] Processing es map creation data...
21-Mar-24 14:29:02 INFO [es_visualization.py] Processing of es map creation data completed
21-Mar-24 14:29:02 INFO [h11_impl.py] 192.168.150.14:60361 - "GET /ES_data_for_map HTTP/1.1" 200
21-Mar-24 14:29:39 INFO [server.py] Shutting down
21-Mar-24 14:29:39 INFO [on.py] Waiting for application shutdown.
21-Mar-24 14:29:39 INFO [on.py] Application shutdown complete.
21-Mar-24 14:29:39 INFO [server.py] Finished server process [1471578]
21-Mar-24 14:30:41 INFO [es_visualization.py] Loading csv file
21-Mar-24 14:30:41 INFO [es_visualization.py] Processing es map creation data...
21-Mar-24 14:30:42 INFO [es_visualization.py] Processing of es map creation data completed
21-Mar-24 14:30:42 INFO [h11_impl.py] 192.168.150.14:60390 - "GET /ES_data_for_map HTTP/1.1" 200
21-Mar-24 14:30:49 ERROR [es_visualization.py] Exception occurred:argument of type 'method' is not iterable.
Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 125, in ids_vs_outlier
    df_assetloc = pd.read_csv(data)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/common.py", line 707, in get_handle
    if _is_binary_mode(path_or_buf, mode) and "b" not in mode:
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/common.py", line 1167, in _is_binary_mode
    return isinstance(handle, _get_binary_io_classes()) or "b" in getattr(
TypeError: argument of type 'method' is not iterable
21-Mar-24 14:30:49 INFO [h11_impl.py] 192.168.150.14:60391 - "GET /ES_outlier HTTP/1.1" 500
21-Mar-24 14:32:22 INFO [server.py] Shutting down
21-Mar-24 14:32:22 INFO [on.py] Waiting for application shutdown.
21-Mar-24 14:32:22 INFO [on.py] Application shutdown complete.
21-Mar-24 14:32:22 INFO [server.py] Finished server process [1471936]
21-Mar-24 14:36:07 ERROR [es_visualization.py] Exception occurred:No columns to parse from file.
Traceback (most recent call last):
  File "/opt/siap/analytics/es/router/es_visualization.py", line 125, in ids_vs_outlier
    df_assetloc = pd.read_csv(data_csv)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1679, in _make_engine
    return mapping[engine](f, **self.options)
  File "/opt/siap/analytics/analytics_env/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 557, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
21-Mar-24 14:36:07 INFO [h11_impl.py] 192.168.150.14:60509 - "GET /ES_outlier HTTP/1.1" 500
21-Mar-24 14:37:41 INFO [server.py] Shutting down
21-Mar-24 14:37:41 INFO [on.py] Waiting for application shutdown.
21-Mar-24 14:37:41 INFO [on.py] Application shutdown complete.
21-Mar-24 14:37:41 INFO [server.py] Finished server process [1472481]
21-Mar-24 14:38:36 INFO [es_visualization.py] Processing data to generate outlier...
21-Mar-24 14:38:36 INFO [es_visualization.py] Outlier detection completed.
21-Mar-24 14:38:36 INFO [h11_impl.py] 192.168.150.14:60540 - "GET /ES_outlier HTTP/1.1" 200
21-Mar-24 14:40:11 INFO [server.py] Shutting down
21-Mar-24 14:40:12 INFO [on.py] Waiting for application shutdown.
21-Mar-24 14:40:12 INFO [on.py] Application shutdown complete.
21-Mar-24 14:40:12 INFO [server.py] Finished server process [1472544]
